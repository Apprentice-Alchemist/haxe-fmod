<xml>
	<set name="FMOD_API_PATH" value="${this_dir}/../lib/Windows" if="windows"/>
	<set name="FMOD_API_PATH" value="${this_dir}/../lib/Mac" if="macos"/>
	<set name="FMOD_API_PATH" value="${this_dir}/../lib/Linux" if="linux"/>


	<!-- Outdated links for other platforms
	<section if="switch">
		<set name="FMOD_API_PATH" value="${LINC_FAXE_PATH}/lib/Switch" />
	</section>
    -->
	<echo value="Found your FMOD API in ${FMOD_API_PATH}!" ifExists="${FMOD_API_PATH}/api" />

	<files id="haxe">
		<compilerflag value="-I${LINC_FAXE_PATH}/faxe/" />
		<compilerflag value="-I${FMOD_API_PATH}/api/core/inc/" />
		<compilerflag value="-I${FMOD_API_PATH}/api/studio/inc/" />

		<!-- Additional linux compiler flags
		<compilerflag value="-std=c++11" if="linux" />
		<compilerflag value="-Wl,-rpath,$ORIGIN" if="linux" />
		-->
	</files>

	<files id="faxe">
		<compilerflag value="-I${LINC_FAXE_PATH}/faxe/" />
		<compilerflag value="-I${FMOD_API_PATH}/api/core/inc/" />
		<compilerflag value="-I${FMOD_API_PATH}/api/studio/inc/" />
		<file name="${LINC_FAXE_PATH}/faxe/linc_faxe.cpp" />
	</files>

	<target id="haxe" toolid="exe" unless="switch">
		<section if="windows HXCPP_M32">
			<lib name="${FMOD_API_PATH}/api/core/lib/x86/fmod_vc.lib" />
			<lib name="${FMOD_API_PATH}/api/studio/lib/x86/fmodstudio_vc.lib" />
		</section>

		<section if="windows HXCPP_M64">
			<lib name="${FMOD_API_PATH}/api/core/lib/x64/fmod_vc.lib" />
			<lib name="${FMOD_API_PATH}/api/studio/lib/x64/fmodstudio_vc.lib" />
		</section>

		<section if="macos">
			<lib name="-L${FMOD_API_PATH}/api/core/lib/"/>
			<lib name="-L${FMOD_API_PATH}/api/studio/lib/"/>
			<lib name="-lfmod"/>
			<lib name="-lfmodstudio"/>
		</section>

		<section if="linux HXCPP_M32">
			<lib name="${FMOD_API_PATH}/api/core/lib/x86/libfmod.so" />
			<lib name="${FMOD_API_PATH}/api/studio/lib/x86/libfmodstudio.so" />
		</section>

		<section if="linux HXCPP_M64">
			<lib name="${FMOD_API_PATH}/api/core/lib/x86_64/libfmod.so" />
			<lib name="${FMOD_API_PATH}/api/studio/lib/x86_64/libfmodstudio.so" />
		</section>
	</target>

	<!--TODO OVERRIDE  BuildMain.xml in project ... in the end I never came up with a true fix for nx and had to blit it over...-->
	<!-- on switch have to copypaster this in BuildMain.xml -->
	<!-- <lib name="C:/HaxeToolkit_347/haxelibs/faxe/git/lib/Switch/api/lowlevel/lib/nx64/libfmod.a" /> -->
	<!-- <lib name="C:/HaxeToolkit_347/haxelibs/faxe/git/lib/Switch/api/studio/lib/nx64/libfmodstudio.a" /> -->

	<section if="windows" unless="switch">
		<section if="windows HXCPP_M32">
			<copyFile name="fmod.dll" from="${FMOD_API_PATH}/api/core/lib/x86" toolId="exe" allowMissing="false"/>
			<copyFile name="fmodstudio.dll" from="${FMOD_API_PATH}/api/studio/lib/x86" toolId="exe" allowMissing="false"/>
		</section>

		<section if="windows HXCPP_M64">
			<copyFile name="fmod.dll" from="${FMOD_API_PATH}/api/core/lib/x64" toolId="exe" allowMissing="false"/>
			<copyFile name="fmodstudio.dll" from="${FMOD_API_PATH}/api/studio/lib/x64" toolId="exe" allowMissing="false"/>
		</section>
	</section>

	<section if="linux HXCPP_M32">
		<copyFile name="libfmod.so" from="${FMOD_API_PATH}/api/core/lib/x86" toolId="exe" allowMissing="false"/>
		<copyFile name="libfmodstudio.so" from="${FMOD_API_PATH}/api/studio/lib/x86" toolId="exe" allowMissing="false"/>
	</section>
	<section if="linux HXCPP_M64">
		<copyFile name="libfmod.so" from="${FMOD_API_PATH}/api/core/lib/x86_64" toolId="exe" allowMissing="false"/>
		<copyFile name="libfmodstudio.so" from="${FMOD_API_PATH}/api/studio/lib/x86_64" toolId="exe" allowMissing="false"/>
	</section>

	<section if="macos">
		<copyFile name="libfmod.dylib" from="${FMOD_API_PATH}/api/core/lib" toolId="exe" allowMissing="false"/>
		<copyFile name="libfmodstudio.dylib" from="${FMOD_API_PATH}/api/studio/lib" toolId="exe" allowMissing="false"/>
	</section>
</xml>